<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
	function loadimg(e){
		const board = document.querySelector('.fimg');
		const file = e.currentTarget.files[0];
		board.src = URL.createObjectURL(file); 
		board.style.visibility ='visible';
	}
		
    async function getImges(){
		let formData = new FormData(form_file);

        const options = {
            method: "post",
            body: formData
        }

        try {
            let response = await fetch("[[@{/rest/uploadfile}]]", options);
            //await 동기화 방식으로해야함
			
            let FoodParsing_dataChang = await response.json();
            //response는 json 파일로 컨버전해서 준다
            
       		let tag_img = document.querySelector('#imgs_Food');
            
            tag_img.value = FoodParsing_dataChang.FoodParsing_data;

        }catch(err){
            alert(err);
        }
        //await 동기화 방식으로해야함
    }
</script>
</head>
<body>
    <br>
    <form method="post" id="form_file" action="" enctype="multipart/form-data">
	<div style="vertical-align: top;">
		<div><img width="150" height="150" class="fimg" src="" style="visibility: hidden;"></div>
		<div>		
			   <input type="text" id="imgs_Food" value="결과값 출력 되는 부분 "/> 
		       <input type="file" name="uploadfile" multiple="multiple" onchange="loadimg(event);"/> 
		       <input type="button" value="보내기" onclick="getImges()"/>
		</div>
	</div>
</form>

    
</body>
</html>